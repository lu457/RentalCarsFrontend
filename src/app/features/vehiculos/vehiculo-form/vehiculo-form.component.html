<div class="form-container">
  <h2>{{ isEditMode() ? "Editar Veh√≠culo" : "Nuevo Veh√≠culo" }}</h2>

  <div *ngIf="isLoading()" class="loading-container">
    <mat-spinner></mat-spinner>
  </div>

  <form [formGroup]="form" class="form-grid">
    <mat-form-field>
      <mat-label>Marca</mat-label>
      <input matInput formControlName="marca" required />
    </mat-form-field>

    <mat-form-field>
      <mat-label>Modelo</mat-label>
      <input matInput formControlName="modelo" required />
    </mat-form-field>

    <mat-form-field>
      <mat-label>A√±o</mat-label>
      <input matInput type="number" formControlName="year" required min="1900" max="2100" />
    </mat-form-field>

    <mat-form-field floatLabel="always">
      <mat-label>Precio por d√≠a</mat-label>
      <input matInput type="number" formControlName="precioPorDia" class="example-right-align" placeholder="0" />
      <span matTextPrefix>$&nbsp;</span>
      <span matTextSuffix>.00</span>
    </mat-form-field>

    <mat-form-field>
      <mat-label>Tipo</mat-label>
      <mat-select formControlName="tipo" required>
        <mat-option value="Sedan">Sed√°n</mat-option>
        <mat-option value="SUV">SUV</mat-option>
        <mat-option value="Camioneta">Camioneta</mat-option>
        <mat-option value="Deportivo">Deportivo</mat-option>
        <mat-option value="Electrico">El√©ctrico</mat-option>
        <mat-option value="Compacto">Compacto</mat-option>
      </mat-select>
    </mat-form-field>
    

    <mat-form-field>
      <mat-label>Motor</mat-label>
      <input matInput formControlName="motor" required />
    </mat-form-field>

    <mat-form-field>
      <mat-label>Cilindros</mat-label>
      <input matInput type="number" formControlName="cilindros" required min="1" />
    </mat-form-field>

    <mat-form-field>
      <mat-label>Puertas</mat-label>
      <input matInput type="number" formControlName="puertas" required min="2" />
    </mat-form-field>

    <mat-form-field>
      <mat-label>Capacidad de pasajeros</mat-label>
      <input matInput type="number" formControlName="capacidadPasajeros" required min="1" />
    </mat-form-field>

    <mat-form-field>
      <mat-label>Combustible</mat-label>
      <mat-select formControlName="combustible" required>
        <mat-option value="Gasolina">Gasolina</mat-option>
        <mat-option value="Diesel">Di√©sel</mat-option>
        <mat-option value="Electrico">El√©ctrico</mat-option>
        <mat-option value="Hibrido">H√≠brido</mat-option>
      </mat-select>
    </mat-form-field>

    <mat-form-field>
      <mat-label>Transmisi√≥n</mat-label>
      <mat-select formControlName="transmision" required>
        <mat-option value="Manual">Manual</mat-option>
        <mat-option value="Automatica">Autom√°tica</mat-option>
      </mat-select>
    </mat-form-field>

    <mat-form-field>
      <mat-label>Calle</mat-label>
      <input matInput formControlName="calle" required />
    </mat-form-field>

    <mat-form-field>
      <mat-label>Ciudad</mat-label>
      <input matInput formControlName="ciudad" required />
    </mat-form-field>

    <mat-form-field>
      <mat-label>Pa√≠s</mat-label>
      <input matInput formControlName="pais" required />
    </mat-form-field>

    <mat-form-field class="full-width">
      <mat-label>Descripci√≥n</mat-label>
      <textarea matInput formControlName="descripcion" required></textarea>
    </mat-form-field>

    <div class="image-upload full-width">
      <label>Subir Im√°genes</label>
      <input #fileInput type="file" (change)="onFileSelected($event)" multiple>

      
      <div class="image-preview" *ngIf="imagePreviews.length > 0">
        <div *ngFor="let img of imagePreviews; let i = index" class="image-container">
          <img [src]="img.url" alt="Previsualizaci√≥n" class="preview-image" />
          
          <button (click)="setPrincipalImage(i)" [class.selected]="img.esPrincipal">
            {{ img.esPrincipal ? 'Principal ‚úÖ' : 'Marcar como principal' }}
          </button>
          <button (click)="removeImage(i)" class="delete-button">üóëÔ∏è Eliminar</button>
        </div>
      </div>
      
    </div>

    <div class="button-container">
      <button mat-raised-button color="primary" (click)="saveVehiculo()">Guardar</button>
      <button mat-stroked-button color="warn" type="button" (click)="cancel()">Cancelar</button>
    </div>
  </form>
</div>
